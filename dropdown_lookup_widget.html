
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dropdown Lookup Widget</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        select, div {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <label for="dropdown">Select a Training:</label>
    <select id="dropdown">
        <option value="">--Select--</option>
    </select>
    <div id="info"></div>

    <script>
        const sheetID = '1KOdkObx6Pd-LzmqKSDn7kFxAShOh_5JREuO5f3HxOs4';
        const query = encodeURIComponent('SELECT C');
        const url = `https://docs.google.com/spreadsheets/d/${1KOdkObx6Pd-LzmqKSDn7kFxAShOh_5JREuO5f3HxOs4}/gviz/tq?sheet=Sheet1&tq=${SELECT C}`;

        fetch(url)
            .then(res => res.text())
            .then(rep => {
                const json = JSON.parse(rep.substr(47).slice(0, -2));
                const dropdown = document.getElementById("dropdown");
                const info = document.getElementById("info");

                const data = {};
                json.table.rows.forEach(row => {
                    const product = row.c[0]?.v;
                    const description = row.c[1]?.v;
                    if (product && description) {
                        data[product] = description;
                        const option = document.createElement("option");
                        option.value = product;
                        option.textContent = product;
                        dropdown.appendChild(option);
                    }
                });

                dropdown.addEventListener("change", () => {
                    const selected = dropdown.value;
                    info.innerHTML = `<strong>${selected}:</strong> ${data[selected] || ''}`;
                });
            });
    </script>
</body>
</html>
